apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: gha-runner-scale-set-controller
  namespace: operations-engineering-github-runners-poc
rules:
  - apiGroups: ["actions.github.com"]
    resources:
      [
        "autoscalingrunnersets",
        "autoscalingrunnersets/finalizers",
        "autoscalingrunnersets/status",
        "ephemeralrunnersets",
        "ephemeralrunnersets/status",
        "ephemeralrunnersets/finalizers",
        "ephemeralrunners",
        "ephemeralrunners/finalizers",
        "ephemeralrunners/status",
        "autoscalinglisteners",
      ]
    verbs: ["create", "delete", "get", "list", "patch", "update", "watch"]

---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: operations-engineering-github-runners-poc-admin
  namespace: operations-engineering-github-runners-poc
subjects:
  - kind: Group
    name: "github:operations-engineering"
    apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: admin
  apiGroup: rbac.authorization.k8s.io

---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: operations-engineering-github-runners-poc
  namespace: operations-engineering-github-runners-poc
subjects:
  - kind: Group
    name: "github:operations-engineering"
    apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: gha-runner-scale-set-controller
  apiGroup: rbac.authorization.k8s.io
