apiVersion: v1
kind: ConfigMap
metadata:
  name: hmpps-manage-intelligence-dashboard
  namespace: hmpps-manage-intelligence-prod
  labels:
    grafana_dashboard: "IMS"
data:
  hmpps-manage-intelligence-prod-dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": {
              "type": "datasource",
              "uid": "grafana"
            },
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "limit": 100,
            "name": "Annotations & Alerts",
            "showIn": 0,
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 1,
      "id": 183,
      "links": [],
      "panels": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 0
          },
          "id": 8,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
              },
              "editorMode": "code",
              "expr": "histogram_quantile(\n  0.5,\n  max(\n    irate(nginx_ingress_controller_request_duration_seconds_bucket{ingress=~\"manage-intelligence-v1-2\", exported_namespace=\"hmpps-manage-intelligence-prod\"}[$__rate_interval])\n  ) by (le)\n)",
              "instant": false,
              "interval": "",
              "legendFormat": "0.5",
              "range": true,
              "refId": "A"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
              },
              "editorMode": "code",
              "expr": "histogram_quantile(\n  0.95,\n  max(\n    irate(nginx_ingress_controller_request_duration_seconds_bucket{ingress=~\"manage-intelligence-v1-2\", exported_namespace=\"hmpps-manage-intelligence-prod\"}[$__rate_interval])\n  ) by (le)\n)",
              "hide": false,
              "instant": false,
              "legendFormat": "0.95",
              "range": true,
              "refId": "B"
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
              },
              "editorMode": "code",
              "expr": "histogram_quantile(\n  1,\n  max(\n    irate(nginx_ingress_controller_request_duration_seconds_bucket{ingress=~\"manage-intelligence-v1-2\", exported_namespace=\"hmpps-manage-intelligence-prod\"}[$__rate_interval])\n  ) by (le)\n)",
              "hide": false,
              "instant": false,
              "legendFormat": "1.0",
              "range": true,
              "refId": "C"
            }
          ],
          "title": "Latency",
          "type": "timeseries"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "description": "IMS Front End Ingress Requests",
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 0
          },
          "hiddenSeries": false,
          "id": 2,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "10.4.0",
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
              },
              "disableTextWrap": false,
              "editorMode": "code",
              "expr": "sum(\n  increase(nginx_ingress_controller_requests{ingress=~\"manage-intelligence|manage-intelligence-.+\", exported_namespace=\"hmpps-manage-intelligence-prod\"}[1m])\n) by (status) != 0",
              "fullMetaSearch": false,
              "includeNullMetadata": true,
              "instant": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "A",
              "useBackend": false
            }
          ],
          "thresholds": [],
          "timeRegions": [],
          "title": "Ingress Requests",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "mode": "time",
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "logBase": 1,
              "show": true
            },
            {
              "format": "short",
              "logBase": 1,
              "show": true
            }
          ],
          "yaxis": {
            "align": false
          }
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "P896B4444D3F0DAB8"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 9
          },
          "id": 9,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "targets": [
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-attachment_metadata_extractor_queue"
              },
              "expression": "",
              "id": "",
              "label": "attachment_metadata_extractor_queue\n",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-attachment_metadata_transformer_queue"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "attachment_metadata_transformer_queue",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "B",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_csv_queue"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "ims_csv_queue",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "C",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_extractor_queue"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "ims_extractor_queue",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "J",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_index_batch_queue_prod"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "ims_index_batch_queue_prod",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "D",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_index_update_queue_prod"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "ims_index_update_queue_prod",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "E",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_pdf_queue"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "ims_pdf_queue",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "F",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims-reprocess_queue"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "ims_reprocess_queue",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "G",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_transformer_queue"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "ims_trasnformer_queue",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "H",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-metadata_status_queue"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "metadata_status_queue",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "I",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "SQS - Approximate Number of Messages Visable (Average)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "P896B4444D3F0DAB8"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 9
          },
          "id": 11,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "targets": [
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-attachment_metadata_extractor_dl_queue"
              },
              "expression": "",
              "id": "",
              "label": "attachment_metadata_extractor_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-attachment_metadata_transformer_dl_queue"
              },
              "expression": "",
              "id": "",
              "label": "attachment_metadata_transformer_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "B",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_csv_dl_queue"
              },
              "expression": "",
              "id": "",
              "label": "ims_csv_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "C",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_extractor_dl_queue"
              },
              "expression": "",
              "id": "",
              "label": "ims_extractor_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "D",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_index_batch_dl_queue_prod"
              },
              "expression": "",
              "id": "",
              "label": "ims_index_batch_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "E",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_index_update_dl_queue_prod"
              },
              "expression": "",
              "id": "",
              "label": "ims_index_update_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "F",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_pdf_dl_queue"
              },
              "expression": "",
              "id": "",
              "label": "ims_pdf_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "G",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_reprocess_dl_queue"
              },
              "expression": "",
              "id": "",
              "label": "ims_reprocess_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "H",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-ims_transformer_dl_queue"
              },
              "expression": "",
              "id": "",
              "label": "ims_transformer_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "I",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "QueueName": "dps-ims-production-releases-prod-metadata_status_dl_queue"
              },
              "expression": "",
              "id": "",
              "label": "metadata_status_dlq",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ApproximateNumberOfMessagesVisible",
              "metricQueryType": 0,
              "namespace": "AWS/SQS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "J",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "SQS - DLQ - Approximate Number of Messages Visable (Average)",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 12,
            "x": 0,
            "y": 18
          },
          "id": 10,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
              },
              "disableTextWrap": false,
              "editorMode": "code",
              "expr": "kube_pod_container_status_restarts_total{namespace=\"hmpps-manage-intelligence-prod\", pod!~\"port-forward.*|.*cronjob.*\"}",
              "fullMetaSearch": false,
              "includeNullMetadata": true,
              "instant": false,
              "legendFormat": "{{pod}}",
              "range": true,
              "refId": "A",
              "useBackend": false
            }
          ],
          "title": "Pod Restarts",
          "type": "timeseries"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "description": "Maximum JVM memory pressure percentage for all data nodes.",
          "fieldConfig": {
            "defaults": {
              "links": []
            },
            "overrides": []
          },
          "fill": 1,
          "fillGradient": 0,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 18
          },
          "hiddenSeries": false,
          "id": 7,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "nullPointMode": "null",
          "options": {
            "alertThreshold": true
          },
          "percentage": false,
          "pluginVersion": "10.4.0",
          "pointradius": 2,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "alias": "JVMMemoryPressure",
              "datasource": {
                "uid": "$datasource"
              },
              "dimensions": {
                "ClientId": "$clientId",
                "DomainName": "$domainName"
              },
              "disableTextWrap": false,
              "editorMode": "code",
              "expr": "aws_es_jvmmemory_pressure_maximum{domain_name=\"cloud-platform-cc15074f\"}",
              "expression": "",
              "fullMetaSearch": false,
              "id": "",
              "includeNullMetadata": true,
              "legendFormat": "{{ if node_id }} {{ node_id }} {{ else }} {{ end }}",
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "JVMMemoryPressure",
              "metricQueryType": 0,
              "namespace": "AWS/ES",
              "range": true,
              "refId": "A",
              "region": "$region",
              "statistic": "Maximum",
              "useBackend": false
            }
          ],
          "thresholds": [],
          "timeRegions": [],
          "title": "OpenSearch Maximum JVMMemoryPressure",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "mode": "time",
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "decimals": 0,
              "format": "percent",
              "logBase": 1,
              "show": true
            },
            {
              "format": "short",
              "logBase": 1,
              "show": true
            }
          ],
          "yaxis": {
            "align": false
          }
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "P896B4444D3F0DAB8"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 27
          },
          "id": 12,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "targets": [
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "DBClusterIdentifier": "cloud-platform-b881bb424eb43e8b"
              },
              "expression": "",
              "id": "",
              "label": "RDS - ServerlessDatabaseCapacity",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ServerlessDatabaseCapacity",
              "metricQueryType": 0,
              "namespace": "AWS/RDS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Maximum"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "P896B4444D3F0DAB8"
              },
              "dimensions": {
                "DBClusterIdentifier": "cloud-platform-9f3aab4d10779bf4"
              },
              "expression": "",
              "hide": false,
              "id": "",
              "label": "RDS Legacy - ServerlessDatabaseCapacity",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "ServerlessDatabaseCapacity",
              "metricQueryType": 0,
              "namespace": "AWS/RDS",
              "period": "",
              "queryMode": "Metrics",
              "refId": "B",
              "region": "default",
              "sqlExpression": "",
              "statistic": "Maximum"
            }
          ],
          "title": "RDS Aurora ACU",
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "decimals": 0,
              "mappings": [],
              "max": 6,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 30
          },
          "id": 13,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
              },
              "disableTextWrap": false,
              "editorMode": "builder",
              "expr": "kube_deployment_status_replicas{namespace=\"hmpps-manage-intelligence-prod\", deployment=\"manage-intelligence\"}",
              "fullMetaSearch": false,
              "includeNullMetadata": true,
              "instant": false,
              "interval": "",
              "legendFormat": "{{deployment}}",
              "range": true,
              "refId": "A",
              "useBackend": false
            },
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus"
              },
              "disableTextWrap": false,
              "editorMode": "builder",
              "expr": "kube_deployment_status_replicas{namespace=\"hmpps-manage-intelligence-prod\", deployment=\"manage-intelligence-api\"}",
              "fullMetaSearch": false,
              "hide": false,
              "includeNullMetadata": true,
              "instant": false,
              "interval": "",
              "legendFormat": "{{deployment}}",
              "range": true,
              "refId": "B",
              "useBackend": false
            }
          ],
          "title": "Horizontal Pod Autoscaling",
          "type": "timeseries"
        }
      ],
      "schemaVersion": 39,
      "tags": [],
      "templating": {
        "list": []
      },
      "time": {
        "from": "now-6h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "browser",
      "title": "HMPPS Manage Intelligence Dashboard Production",
      "uid": "ldzdmaec96rpwrz",
      "version": 30,
      "weekStart": ""
    }